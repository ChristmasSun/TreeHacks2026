services:
  # Expression Analysis Dashboard (Demeanor Detection)
  - type: web
    name: expression-dashboard
    runtime: python
    region: oregon
    plan: free
    rootDir: expression-dashboard
    buildCommand: pip install uv && uv sync
    startCommand: uv run uvicorn app:app --host 0.0.0.0 --port $PORT
    healthCheckPath: /api/emotions
    envVars:
      - key: PYTHONUNBUFFERED
        value: "1"

  # Python FastAPI Backend
  - type: web
    name: ai-professor-backend
    env: python
    region: oregon
    plan: free  # Change to 'starter' for production
    buildCommand: cd backend && pip install -r requirements.txt
    startCommand: cd backend && uvicorn app:app --host 0.0.0.0 --port $PORT
    healthCheckPath: /health

    envVars:
      # Database connection (automatically populated from database service)
      - key: DATABASE_URL
        fromDatabase:
          name: ai-professor-db
          property: connectionString

      # Zoom API credentials (set these in Render dashboard)
      - key: ZOOM_ACCOUNT_ID
        sync: false
      - key: ZOOM_CLIENT_ID
        sync: false
      - key: ZOOM_CLIENT_SECRET
        sync: false

      # HeyGen API credentials
      - key: HEYGEN_API_KEY
        sync: false

      # Deepgram API credentials
      - key: DEEPGRAM_API_KEY
        sync: false

      # Application settings
      - key: DEBUG
        value: False
      - key: LOG_LEVEL
        value: INFO
      - key: PYTHONUNBUFFERED
        value: true

databases:
  # PostgreSQL Database
  - name: ai-professor-db
    databaseName: breakout_system
    plan: free  # Change to 'starter' for production
    region: oregon
